x secret
x leakeme
print leakeme
printf leakeme
print leakeme
r
print leakme
r
r
quit
r
print leakme
quit
x secret
break leak_address
c
r
c
quit
break main
r
print leakme
x &leakme
x/s &leakme
x secret
disas secret
quit
break main
r
x secret
quit
x secret
quit
x secret
quit
x secret
clear
exit
quit
break main
r
x leakme
x &leakme
quit
break main
r
x &leakme
x secret
r
c
AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHH
quit
r < "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHH"
r < "echo AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHH"
exit
quit
r < /tmp/output
set follow-fork-mode child
quit
set follow-fork-mode child
r < /tmp/output
exit
quit
quit
x secret
x leakme
x &leakme
x &secret
exit
quit
set follow-fork-mode child
r
asd
quit
break main
r
x secret
x &leakeme
x &leakme
quit
break main
c
r
x secret
x &leakme
exit
quit
break main
c
r
x &leakme
x &secret
uit
quit
set disable-randomization off
r
d
r
r
r
quit
r
quit
disas main
disas 0x000012ea
quit
quit
disas main
break main
c
r
disas main
disas 0x56556222
break *0x5655628c
c
quit
set follow-fork-mode child
r
r
r
r
quit
set disable-randomization off
set $_exitcode = -1
run
ks
ks
quit
set disable-randomization off
r < /tmp/output
x $eip
info registers
quit
r < /tmp/output
quit
