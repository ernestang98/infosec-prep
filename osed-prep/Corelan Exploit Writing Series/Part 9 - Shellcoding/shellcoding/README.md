### Static Analysis

python2 script.py

Creates dangerous shellcode and calculator shellcode

### Dynamic Analysis

MessageBox.exe Directory

Use Ida to analyse strings and functions used

Can also use Immunity Debugger/Windbg to analyse

Functions used for MessageBox(): MessageBoxA from USER32.dll

### Toolkit

1. pvePushString.pl script

	- pushes text to stack
	
2. pvefindaddr.py

	- Convert assembly to opcodes

	- many other features
	
	- Used in [bypassing security mechanisms](https://www.corelan.be/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/)
	
	- Used in [unicode exploits](https://www.corelan.be/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/)
	
 	- Used in [egghunting](https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/)

3. Dumpbin.exe

	- https://www.pconlife.com/viewfileinfo/dumpbin-exe/
	
4. ndisasm.exe

	- https://www.nasm.us/pub/nasm/releasebuilds/2.15.05/win64/

	- Convert shellcode to assembly
	
	- ndisasm.exe -b 32 calc_shellcode.bin

5. nasm.exe

	- convert assembly to shellcode
	
6. BETA3.py

	- Convert shellcode to strings/assembly
	
	- python2 BETA3.py shellcode.bin

7. pveReadbin.pl 

	- Reads shellcode
	
	- perl pveReadbin.pl shellcode.bin

### Crafting a good shellcode

- Prepare API call (MessageBoxA)

- Prepare stack (arguments to MessageBoxA)

- Prepare exit function

	1. kernel32.dll - ExitProcess, ExitThread
	
	2. SEH - trigger one

### Links

- https://defuse.ca/online-x86-assembler.htm#disassembly

- https://www.fuzzysecurity.com/tutorials/expDev/6.html

- https://www.corelan.be/index.php/2010/02/25/exploit-writing-tutorial-part-9-introduction-to-win32-shellcoding/

- https://stackoverflow.com/questions/32793117/assembly-call-vs-jmp