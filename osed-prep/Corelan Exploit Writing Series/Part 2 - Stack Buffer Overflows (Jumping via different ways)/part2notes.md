how to jmp reliably... basically

1. jmp/call esp/register

2. pop ret - if theres an address on the stack that points to shellcode, then just pop ... pop ret till esp points to that address

3. push ret - if theres an address in any register that points to shellcode, then just push it to the stack

4. jmp reg offset - if register points to middle of shellcode, so jmp to that register with some offset such that you point to the start of the shellcode

5. blind return - just a RET instruction followed by esp address which points to shell code.

6. SEH - purposely generate an exception for the application to handle, execute your shellcode there

Overcoming space limitations

1. jmp - set your padding as the shellcode, then just jmp back when u overwrite eip

2. find possible registers that point to your payload, then combine it with good old jmp instructions (e.g. if eax points to the start of your payload like asdasdasd AAAAAAAAAAAAAAAAAAAAAAAAAAAAaa, then what you can do is that you can add 0xa to eax followed by a jmp or call eax in order to ensure that your eax points to your payload before jmping there)



EDIT - a CAN be used for exploit but is not reliable as if you restart the application and try to re run it, it will fail. 
purpose of a is to convert assembly instruction into opcodes
so use a and write few opcodesm after that use u to view the opcodes

!py mona find -s "\x54\xc3" -m asdasdasd.dll (push esp, ret)

s asdasdasd l asdasdasd ff e4 no need `0x` for the addresses



https://installati.one/ubuntu/20.04/nasm/

https://github.com/fishstiqz/nasmshell

https://github.com/nickvido/littleoldearthquake/tree/master/corelan/exploit-tutorial-pt02

https://x3tb3t.github.io/2018/03/29/mona/


https://stackoverflow.com/questions/34434313/buffer-overflow-how-to-do-a-relative-jump-from-esp

https://www.abatchy.com/2017/05/jumping-to-shellcode.html


d esp to dump esp

https://www.securitysift.com/windows-exploit-development-part-4-locating-shellcode-jumps/

https://faydoc.tripod.com/cpu/popad.htm

https://www.felixcloutier.com/x86/popa:popad.html
